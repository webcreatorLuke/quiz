<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quiz Battle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- iOS web app meta (for Add to Home Screen) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Quiz Battle">

  <style>
    :root {
      --bg: #ffffff;
      --fg: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
      --accent: #0a84ff;
      --accent-muted: #e0f0ff;
      --danger: #ff3b30;
      --success: #34c759;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    h1 {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 600;
    }

    .subtitle {
      margin: 0;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .ios-download-box {
      display: none;
      padding: 8px 0 0;
    }

    .ios-download-btn {
      border: none;
      background: transparent;
      color: var(--accent);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--accent);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .ios-download-btn-icon {
      font-size: 1.1rem;
    }

    .ios-instructions {
      display: none;
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 10px;
      background: var(--accent-muted);
      font-size: 0.8rem;
      color: #1f2933;
    }

    main {
      flex: 1;
      max-width: 960px;
      width: 100%;
      margin: 0 auto;
      padding: 12px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .top-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .search-box input {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 0.9rem;
      width: 220px;
    }

    .selected-category-label {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .categories {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .category-btn {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      color: var(--fg);
      font-size: 0.85rem;
      cursor: pointer;
    }

    .category-btn.active {
      color: var(--accent);
      border-color: var(--accent);
      background: #f5f9ff;
    }

    .game-area {
      display: grid;
      grid-template-columns: 3fr 2fr;
      gap: 12px;
    }

    @media (max-width: 800px) {
      .game-area {
        grid-template-columns: 1fr;
      }
    }

    .card {
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #ffffff;
      padding: 12px;
    }

    .status-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .timer {
      font-weight: 600;
      color: #ff9500;
    }

    .points {
      font-weight: 600;
      color: var(--success);
    }

    .question-text {
      font-size: 1rem;
      font-weight: 500;
      margin: 6px 0 8px;
    }

    .answers {
      display: grid;
      gap: 6px;
      margin-top: 4px;
    }

    .answer-btn {
      text-align: left;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #f9fafb;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .answer-btn.correct {
      background: #e6f9ec;
      border-color: var(--success);
      color: #0b7030;
    }

    .answer-btn.wrong {
      background: #ffecec;
      border-color: var(--danger);
      color: #7a1610;
    }

    .answer-btn:disabled {
      opacity: 0.75;
      cursor: default;
    }

    .next-btn {
      margin-top: 8px;
      border: none;
      background: transparent;
      color: var(--accent);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 6px 0;
      cursor: pointer;
    }

    .next-btn:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .robots-card-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .robot-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      font-size: 0.9rem;
      border-bottom: 1px solid var(--border);
    }

    .robot-row:last-child {
      border-bottom: none;
    }

    .robot-name {
      font-weight: 500;
    }

    .you-label {
      color: var(--accent);
      font-weight: 600;
    }

    footer {
      padding: 8px 16px;
      border-top: 1px solid var(--border);
      font-size: 0.8rem;
      color: var(--muted);
      text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-top">
      <div>
        <h1>Quiz Battle</h1>
        <p class="subtitle">Play timed trivia vs robots. 30 seconds, up to 1000 points per question.</p>
      </div>
      <div class="ios-download-box" id="iosDownloadBox">
        <button class="ios-download-btn" id="iosDownloadBtn">
          <span class="ios-download-btn-icon">⬇️</span>
          <span>Download for iOS</span>
        </button>
      </div>
    </div>
    <div class="ios-instructions" id="iosInstructions">
      <strong>Install on iPhone:</strong>
      <ol style="padding-left:18px; margin:6px 0;">
        <li>Tap the <strong>Share</strong> button in Safari.</li>
        <li>Scroll and tap <strong>Add to Home Screen</strong>.</li>
        <li>Tap <strong>Add</strong>. Your app appears on the home screen.</li>
      </ol>
      <span style="font-size:0.75rem;">This uses your browser to install the app; iOS doesn’t allow direct .ipa downloads from websites.</span>
    </div>
  </header>

  <main>
    <div class="top-bar">
      <div class="search-box">
        <input id="searchInput" type="text" placeholder="Search quiz type (e.g. football, history)…">
      </div>
      <div class="selected-category-label" id="selectedCategoryLabel">
        Selected: <strong>Football</strong>
      </div>
    </div>

    <div class="categories" id="categoriesContainer"></div>

    <div class="game-area">
      <div class="card">
        <div class="status-line">
          <div>Time left: <span class="timer" id="timerDisplay">30</span>s</div>
          <div>Last question: <span class="points" id="lastPointsDisplay">0</span> pts</div>
        </div>
        <div class="question-text" id="questionText">Loading question…</div>
        <div class="answers" id="answersContainer"></div>
        <button class="next-btn" id="nextButton">Next question</button>
      </div>

      <div class="card">
        <div class="robots-card-title">Scores</div>
        <div class="robot-row">
          <div class="robot-name you-label">You</div>
          <div id="yourScoreDisplay">0 pts</div>
        </div>
        <div class="robot-row">
          <div class="robot-name">Robot Alpha</div>
          <div id="robot1ScoreDisplay">0 pts</div>
        </div>
        <div class="robot-row">
          <div class="robot-name">Robot Beta</div>
          <div id="robot2ScoreDisplay">0 pts</div>
        </div>
        <div class="robot-row">
          <div class="robot-name">Robot Gamma</div>
          <div id="robot3ScoreDisplay">0 pts</div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    Quiz Battle · Web app style quiz · Add to Home Screen on iOS for app‑like experience
  </footer>

  <script>
    // --- iOS "Download" detection (Add to Home Screen helper) ---
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
    const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

    const iosDownloadBox = document.getElementById("iosDownloadBox");
    const iosDownloadBtn = document.getElementById("iosDownloadBtn");
    const iosInstructions = document.getElementById("iosInstructions");

    if (isIOS && isSafari) {
      iosDownloadBox.style.display = "block";
    }

    iosDownloadBtn.addEventListener("click", () => {
      iosInstructions.style.display =
        iosInstructions.style.display === "block" ? "none" : "block";
    });

    // --- Quiz game logic ---

    const categories = [
      {
        id: "football",
        name: "Football",
        tags: ["football", "soccer", "sports"],
        questions: [
          {
            text: "Which country won the FIFA World Cup in 2018?",
            answers: ["Brazil", "Germany", "France", "Argentina"],
            correctIndex: 2
          },
          {
            text: "Which player is known as 'CR7'?",
            answers: ["Lionel Messi", "Neymar Jr", "Cristiano Ronaldo", "Kylian Mbappé"],
            correctIndex: 2
          },
          {
            text: "Which club has won the most UEFA Champions League titles?",
            answers: ["Barcelona", "AC Milan", "Real Madrid", "Liverpool"],
            correctIndex: 2
          },
          {
            text: "In football, how many players start on the field per team?",
            answers: ["9", "10", "11", "12"],
            correctIndex: 2
          },
          {
            text: "Which country hosted the 2014 FIFA World Cup?",
            answers: ["Brazil", "Russia", "Germany", "South Africa"],
            correctIndex: 0
          }
        ]
      },
      {
        id: "world",
        name: "World & Geography",
        tags: ["world", "geography", "countries", "maps"],
        questions: [
          {
            text: "What is the capital of Japan?",
            answers: ["Tokyo", "Seoul", "Beijing", "Osaka"],
            correctIndex: 0
          },
          {
            text: "Which continent is the Sahara Desert on?",
            answers: ["Asia", "Africa", "Australia", "South America"],
            correctIndex: 1
          },
          {
            text: "Which country has the largest population (recent data)?",
            answers: ["United States", "China", "India", "Russia"],
            correctIndex: 2
          },
          {
            text: "Which ocean is the largest?",
            answers: ["Indian", "Atlantic", "Arctic", "Pacific"],
            correctIndex: 3
          },
          {
            text: "Mount Everest lies on the border of Nepal and which country?",
            answers: ["India", "China", "Bhutan", "Pakistan"],
            correctIndex: 1
          }
        ]
      },
      {
        id: "history",
        name: "History & Politics",
        tags: ["history", "president", "war", "politics"],
        questions: [
          {
            text: "Who was the first President of the United States?",
            answers: ["Abraham Lincoln", "George Washington", "Thomas Jefferson", "John Adams"],
            correctIndex: 1
          },
          {
            text: "In what year did World War II end?",
            answers: ["1945", "1939", "1918", "1950"],
            correctIndex: 0
          },
          {
            text: "Which empire was ruled by Julius Caesar?",
            answers: ["Greek Empire", "Roman Empire", "Ottoman Empire", "Persian Empire"],
            correctIndex: 1
          },
          {
            text: "The fall of the Berlin Wall happened in which year?",
            answers: ["1969", "1979", "1989", "1999"],
            correctIndex: 2
          },
          {
            text: "What document begins with 'We the People'?",
            answers: ["Magna Carta", "US Constitution", "Bill of Rights", "Declaration of Independence"],
            correctIndex: 1
          }
        ]
      },
      {
        id: "science",
        name: "Science & Space",
        tags: ["science", "space", "physics", "chemistry"],
        questions: [
          {
            text: "What planet is known as the Red Planet?",
            answers: ["Venus", "Mars", "Jupiter", "Mercury"],
            correctIndex: 1
          },
          {
            text: "What is the chemical symbol for water?",
            answers: ["O2", "H2O", "CO2", "HO2"],
            correctIndex: 1
          },
          {
            text: "What force keeps us on the ground?",
            answers: ["Magnetism", "Friction", "Gravity", "Electricity"],
            correctIndex: 2
          },
          {
            text: "Which galaxy do we live in?",
            answers: ["Andromeda", "Sombrero", "Whirlpool", "Milky Way"],
            correctIndex: 3
          },
          {
            text: "What gas do plants mainly take in for photosynthesis?",
            answers: ["Oxygen", "Nitrogen", "Carbon dioxide", "Helium"],
            correctIndex: 2
          }
        ]
      },
      {
        id: "mixed",
        name: "Mixed Trivia",
        tags: ["mixed", "random", "general"],
        questions: [
          {
            text: "Which company created the iPhone?",
            answers: ["Google", "Apple", "Microsoft", "Samsung"],
            correctIndex: 1
          },
          {
            text: "Which sport is known as 'the beautiful game'?",
            answers: ["Basketball", "Baseball", "Football (Soccer)", "Tennis"],
            correctIndex: 2
          },
          {
            text: "How many continents are commonly taught on Earth?",
            answers: ["5", "6", "7", "8"],
            correctIndex: 2
          },
          {
            text: "Which animal is known as the 'king of the jungle'?",
            answers: ["Tiger", "Elephant", "Lion", "Gorilla"],
            correctIndex: 2
          },
          {
            text: "What is the largest planet in our solar system?",
            answers: ["Mars", "Earth", "Jupiter", "Saturn"],
            correctIndex: 2
          }
        ]
      }
    ];

    let selectedCategoryId = "football";
    let currentQuestion = null;
    let timer = null;
    let timeLeft = 30;
    let answered = false;

    let yourScore = 0;
    let robot1Score = 0;
    let robot2Score = 0;
    let robot3Score = 0;

    const categoriesContainer = document.getElementById("categoriesContainer");
    const searchInput = document.getElementById("searchInput");
    const selectedCategoryLabel = document.getElementById("selectedCategoryLabel");
    const questionTextEl = document.getElementById("questionText");
    const answersContainer = document.getElementById("answersContainer");
    const timerDisplay = document.getElementById("timerDisplay");
    const lastPointsDisplay = document.getElementById("lastPointsDisplay");
    const nextButton = document.getElementById("nextButton");
    const yourScoreDisplay = document.getElementById("yourScoreDisplay");
    const robot1ScoreDisplay = document.getElementById("robot1ScoreDisplay");
    const robot2ScoreDisplay = document.getElementById("robot2ScoreDisplay");
    const robot3ScoreDisplay = document.getElementById("robot3ScoreDisplay");

    function renderCategories(filterText = "") {
      categoriesContainer.innerHTML = "";
      const lower = filterText.toLowerCase();

      categories.forEach(cat => {
        const matches =
          cat.name.toLowerCase().includes(lower) ||
          cat.tags.some(tag => tag.toLowerCase().includes(lower));

        if (!matches) return;

        const btn = document.createElement("button");
        btn.textContent = cat.name;
        btn.className = "category-btn";
        if (cat.id === selectedCategoryId) {
          btn.classList.add("active");
        }
        btn.addEventListener("click", () => {
          selectedCategoryId = cat.id;
          selectedCategoryLabel.innerHTML = `Selected: <strong>${cat.name}</strong>`;
          renderCategories(searchInput.value);
          startNewQuestion();
        });
        categoriesContainer.appendChild(btn);
      });
    }

    function getRandomQuestionFromSelectedCategory() {
      const category = categories.find(c => c.id === selectedCategoryId);
      if (!category || category.questions.length === 0) return null;
      const index = Math.floor(Math.random() * category.questions.length);
      return category.questions[index];
    }

    function resetTimer() {
      if (timer) clearInterval(timer);
      timeLeft = 30;
      timerDisplay.textContent = timeLeft;
      timer = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timer);
          handleTimeUp();
        }
      }, 1000);
    }

    function handleTimeUp() {
      if (answered) return;
      answered = true;
      revealCorrect(null);
      lastPointsDisplay.textContent = "0";
      simulateRobots();
    }

    function revealCorrect(selectedIndex) {
      const buttons = answersContainer.querySelectorAll("button");
      buttons.forEach((btn, index) => {
        btn.disabled = true;
        if (index === currentQuestion.correctIndex) {
          btn.classList.add("correct");
        } else if (index === selectedIndex && index !== currentQuestion.correctIndex) {
          btn.classList.add("wrong");
        }
      });
    }

    function simulateRobots() {
      const robotChanceToBeRight = 0.7;

      [1, 2, 3].forEach(robotNum => {
        const isRight = Math.random() < robotChanceToBeRight;
        let gained = 0;
        if (isRight) {
          gained = Math.floor(Math.random() * 1000) + 1;
        }
        if (robotNum === 1) {
          robot1Score += gained;
        } else if (robotNum === 2) {
          robot2Score += gained;
        } else {
          robot3Score += gained;
        }
      });

      updateScoreDisplays();
    }

    function updateScoreDisplays() {
      yourScoreDisplay.textContent = yourScore + " pts";
      robot1ScoreDisplay.textContent = robot1Score + " pts";
      robot2ScoreDisplay.textContent = robot2Score + " pts";
      robot3ScoreDisplay.textContent = robot3Score + " pts";
    }

    function startNewQuestion() {
      if (timer) clearInterval(timer);
      answered = false;
      currentQuestion = getRandomQuestionFromSelectedCategory();
      if (!currentQuestion) {
        questionTextEl.textContent = "No questions available for this category yet.";
        answersContainer.innerHTML = "";
        nextButton.disabled = true;
        return;
      }

      questionTextEl.textContent = currentQuestion.text;
      answersContainer.innerHTML = "";
      currentQuestion.answers.forEach((answerText, index) => {
        const btn = document.createElement("button");
        btn.className = "answer-btn";
        btn.textContent = answerText;
        btn.addEventListener("click", () => {
          if (answered) return;
          answered = true;
          clearInterval(timer);

          const isCorrect = index === currentQuestion.correctIndex;
          revealCorrect(index);

          if (isCorrect) {
            const points = Math.floor(Math.random() * 1000) + 1;
            yourScore += points;
            lastPointsDisplay.textContent = points;
          } else {
            lastPointsDisplay.textContent = "0";
          }

          updateScoreDisplays();
          simulateRobots();
        });
        answersContainer.appendChild(btn);
      });

      nextButton.disabled = false;
      resetTimer();
    }

    searchInput.addEventListener("input", () => {
      renderCategories(searchInput.value);
    });

    nextButton.addEventListener("click", () => {
      startNewQuestion();
    });

    renderCategories();
    selectedCategoryLabel.innerHTML = `Selected: <strong>Football</strong>`;
    startNewQuestion();
  </script>
</body>
</html>
